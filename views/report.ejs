<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<style>
@page { size: A4; margin: 0; }
html, body { margin:0; padding:0; font-family:"Times New Roman", serif; }

/* Each PDF page */
.page { width:210mm; height:297mm; page-break-after:always; position:relative; box-sizing:border-box; overflow:hidden; }

/* Header */
.header { display:flex; justify-content:space-between; align-items:flex-start; padding:10mm 14mm 0 14mm; }
.header img { height:42px; object-fit:contain; }

/* Footer */
.footer-center { position:absolute; left:0; right:0; bottom:32px; text-align:center; font-size:13px; }
.footer-year { color:#4b0082; font-weight:bold; }
.footer-institute { color:#b30000; font-weight:bold; line-height:1.3; }

/* Page number & separator */
.page-sep { position:absolute; left:5%; right:5%; bottom:26px; height:1px; background:#ccc; }
.page-number { position:absolute; right:16mm; bottom:10px; font-size:12px; color:#333; }

/* Titles & content styles */
.dept-title { text-align:center; margin-top:6mm; font-weight:bold; color:#b30000; font-size:18px; }
.program-line { text-align:center; color:#4b0082; font-weight:bold; margin-top:3mm; }
.title-main { text-align:center; margin-top:12mm; font-size:20px; color:#4b0082; font-weight:bold; text-decoration:underline; }

.info-table { width:75%; margin:14mm auto; border-collapse:collapse; font-size:14px; table-layout:fixed; }
.info-table td { border:1px solid #c7a4a4; padding:8px 10px; vertical-align:top; word-wrap:break-word; }
.info-label { background:#e8cfcf; font-weight:bold; color:#4a2a2a; width:30%; }
.info-value { background:#f8eaea; color:#4a2a2a; }

.toc-title { text-align:center; margin-top:18mm; font-size:20px; font-weight:bold; color:#4b0082; text-decoration:underline; }
.toc-table { width:75%; margin:14mm auto; border-collapse:collapse; font-size:14px; table-layout:fixed; }
.toc-table th { background:#4b0082; color:#fff; padding:6px; border:1px solid #4b0082; }
.toc-table td { background:#f1d5d5; color:#4b0082; font-weight:bold; padding:6px; border:1px solid #4b0082; word-wrap:break-word; }

.inv-title, .poster-title, .resource-title, .session-title { text-align:center; margin-top:18mm; font-size:20px; font-weight:800; color:#4b0082; text-decoration:underline; }

/* stacked images */
.stack-img-wrap { width:100%; display:flex; flex-direction:column; align-items:center; gap:8mm; margin-top:10mm; }
.stack-img { width:78%; height:90mm; object-fit:cover; border:2px solid #4b0082; display:block; }

/* resource text */
.resource-text { width:75%; margin:16mm auto; font-size:14px; text-align:justify; line-height:1.5; white-space: pre-wrap; word-wrap: break-word; overflow-wrap:break-word; }

/* session styles */
.session-table { width:85%; margin:10mm auto 0 auto; border-collapse:collapse; font-size:13px; }
.session-table td { border:1px solid #000; padding:6px; vertical-align:middle; }
.session-activity-title { text-align:center; color:#1e3a8a; font-weight:bold; margin-top:6mm; }
.preamble { width:85%; margin:8mm auto 0 auto; border:1px solid #000; text-align:center; padding:6px; font-weight:bold; }
.summary-box { width:85%; margin:6mm auto 0 auto; padding:10px; border:1px solid #000; font-size:12.5px; line-height:1.5; text-align:justify; white-space: pre-wrap; }

/* attendance */
.att-section-title { text-align:center; margin-top:6mm; font-weight:bold; color:#4b0082; font-size:18px; }
.att-img-wrap { width:100%; display:flex; justify-content:center; margin-top:10mm; }
.att-img { max-width:80%; max-height:200mm; object-fit:contain; border:1px solid #ddd; }

</style>
</head>
<body>

<% let footerShown = false; %>

<!-- PAGE 1 -->
<div class="page">
  <div class="header">
    <img src="<%= data.headerLeft %>">
    <img src="<%= data.headerRight %>">
  </div>

  <div class="dept-title">Department of Computer Science & Engineering</div>
  <div class="program-line"><%= data.programLine %></div>
  <div class="title-main">ACTIVITY CONDUCTED REPORT</div>

  <table class="info-table" role="presentation">
    <tr><td class="info-label">Activity Name:</td><td class="info-value"><%= data.activityName %></td></tr>
    <tr><td class="info-label">Co-ordinator:</td><td class="info-value"><%= data.coordinator %></td></tr>
    <tr><td class="info-label">Date:</td><td class="info-value"><%= data.activityDate %></td></tr>
    <tr><td class="info-label">Duration:</td><td class="info-value"><%= data.duration %></td></tr>
    <tr><td class="info-label">PO &amp; POs:</td><td class="info-value"><%= data.po %></td></tr>
  </table>

  <% if (!footerShown) { footerShown = true; %>
  <div class="footer-center">
    <div class="footer-year">ACADEMIC YEAR <%= data.academicYear %></div>
    <div class="footer-institute">
      ATRIA INSTITUTE OF TECHNOLOGY,<br>
      Adjacent Bangalore Baptist Hospital, Hebbal,<br>
      Bengaluru - 560 024
    </div>
  </div>
  <div class="page-sep"></div>
  <% } %>

  <div class="page-number"></div>
</div>

<!-- PAGE 2 (TOC) -->
<div class="page">
  <div class="header">
    <img src="<%= data.headerLeft %>">
    <img src="<%= data.headerRight %>">
  </div>

  <div class="toc-title">TABLE OF CONTENTS</div>

  <table class="toc-table" role="presentation">
    <thead><tr><th style="width:20%;">Sl. No</th><th>CONTENT</th></tr></thead>
    <tbody>
      <% (tocRows || []).forEach(function(item, index){ %>
        <tr><td style="width:20%;"><%= index + 1 %>.</td><td><%= item %></td></tr>
      <% }) %>
    </tbody>
  </table>

  <div class="page-number"></div>
</div>

<!-- INVITATION (2 stacked per page) -->
<% for (let i = 0; i < (invitationUrls || []).length; i += 2) { %>
  <div class="page">
    <div class="header">
      <img src="<%= data.headerLeft %>">
      <img src="<%= data.headerRight %>">
    </div>

    <% if (i === 0) { %>
      <div class="inv-title">INVITATION</div>
    <% } else { %>
      <div style="height:18mm;"></div>
    <% } %>

    <div class="stack-img-wrap">
      <img src="<%= invitationUrls[i] %>" class="stack-img">
      <% if (invitationUrls[i+1]) { %>
        <img src="<%= invitationUrls[i+1] %>" class="stack-img">
      <% } %>
    </div>

    <div class="page-number"></div>
  </div>
<% } %>

<!-- POSTER (2 stacked per page) -->
<% for (let i = 0; i < (posterUrls || []).length; i += 2) { %>
  <div class="page">
    <div class="header">
      <img src="<%= data.headerLeft %>">
      <img src="<%= data.headerRight %>">
    </div>

    <% if (i === 0) { %>
      <div class="poster-title">POSTER</div>
    <% } else { %>
      <div style="height:18mm;"></div>
    <% } %>

    <div class="stack-img-wrap">
      <img src="<%= posterUrls[i] %>" class="stack-img">
      <% if (posterUrls[i+1]) { %>
        <img src="<%= posterUrls[i+1] %>" class="stack-img">
      <% } %>
    </div>

    <div class="page-number"></div>
  </div>
<% } %>

<!-- RESOURCE PERSON -->
<div class="page">
  <div class="header">
    <img src="<%= data.headerLeft %>">
    <img src="<%= data.headerRight %>">
  </div>

  <div class="resource-title">RESOURCE PERSON DETAILS</div>
  <div style="display:flex; justify-content:center; margin-top:12mm;">
    <% if (resourceUrls && resourceUrls.length > 0) { %>
      <img src="<%= resourceUrls[0] %>" style="width:55mm; height:55mm; object-fit:cover; border:1px solid #ccc;">
    <% } %>
  </div>

  <div class="resource-text"><%= data.resourceText || '' %></div>

  <div class="page-number"></div>
</div>

<!-- SESSION REPORT -->
<div class="page">
  <div class="header">
    <img src="<%= data.headerLeft %>">
    <img src="<%= data.headerRight %>">
  </div>

  <div class="session-title">SESSION REPORT</div>

  <table class="session-table">
    <tr><td style="width:30%; font-weight:bold;">Session Name</td><td colspan="3"><%= data.sessionName || '' %></td></tr>
    <tr><td style="font-weight:bold;">Resource Person</td><td colspan="3"><%= data.sessionResourcePerson || '' %></td></tr>
    <tr><td style="font-weight:bold;">Co-ordinator(s)</td><td colspan="3"><%= data.sessionCoordinators || '' %></td></tr>
    <tr><td style="font-weight:bold;">Start Date</td><td style="width:25%;"><%= data.sessionStartDate || '' %></td><td style="font-weight:bold; width:12%;">Time</td><td style="width:25%;"><%= data.sessionStartTime || '' %></td></tr>
    <tr><td style="font-weight:bold;">End Date</td><td><%= data.sessionEndDate || '' %></td><td style="font-weight:bold;">Time</td><td><%= data.sessionEndTime || '' %></td></tr>
    <tr><td style="font-weight:bold;">Intended Participants</td><td colspan="3"><%= data.sessionParticipants || '' %></td></tr>
  </table>

  <div class="session-activity-title"><%= data.sessionActivityTitle || '' %></div>
  <div class="preamble"><%= data.sessionPreamble || '' %></div>

  <div class="summary-box"><%= data.sessionSummary || '' %></div>

  <div class="page-number"></div>
</div>

<!-- ATTENDANCE SECTIONS (each image becomes a page; title shown per-page) -->
<% if (attendanceSections && attendanceSections.length > 0) { %>
  <% attendanceSections.forEach(function(section, sIndex){ 
       const imgs = section.images || [];
       const title = section.title || "";
  %>
    <% imgs.forEach(function(imgUrl, imgIndex){ %>
      <div class="page">
        <div class="header">
          <img src="<%= data.headerLeft %>">
          <img src="<%= data.headerRight %>">
        </div>

        <% if (sIndex === 0 && imgIndex === 0) { %>
          <div class="inv-title">ATTENDANCE</div>
        <% } else { %>
          <div style="height:18mm;"></div>
        <% } %>

        <div class="att-section-title"><%= title %></div>

        <div class="att-img-wrap"><img src="<%= imgUrl %>" class="att-img"></div>

        <div class="page-number"></div>
      </div>
    <% }) %>
  <% }) %>
<% } %>

<!-- PHOTOS (2 stacked per page) -->
<% for (let i = 0; i < (photosUrls || []).length; i += 2) { %>
  <div class="page">
    <div class="header">
      <img src="<%= data.headerLeft %>">
      <img src="<%= data.headerRight %>">
    </div>

    <% if (i === 0) { %>
      <div class="inv-title">PHOTOS</div>
    <% } else { %>
      <div style="height:18mm;"></div>
    <% } %>

    <div class="stack-img-wrap">
      <img src="<%= photosUrls[i] %>" class="stack-img">
      <% if (photosUrls[i+1]) { %>
        <img src="<%= photosUrls[i+1] %>" class="stack-img">
      <% } %>
    </div>

    <div class="page-number"></div>
  </div>
<% } %>

<!-- FEEDBACK (2 stacked per page) -->
<% for (let i = 0; i < (feedbackUrls || []).length; i += 2) { %>
  <div class="page">
    <div class="header">
      <img src="<%= data.headerLeft %>">
      <img src="<%= data.headerRight %>">
    </div>

    <% if (i === 0) { %>
      <div class="inv-title">FEEDBACK</div>
    <% } else { %>
      <div style="height:18mm;"></div>
    <% } %>

    <div class="stack-img-wrap">
      <img src="<%= feedbackUrls[i] %>" class="stack-img">
      <% if (feedbackUrls[i+1]) { %>
        <img src="<%= feedbackUrls[i+1] %>" class="stack-img">
      <% } %>
    </div>

    <div class="page-number"></div>
  </div>
<% } %>

<!-- Auto page numbering script -->
<script>
document.addEventListener("DOMContentLoaded", function(){
  const pages = document.querySelectorAll('.page');
  pages.forEach((p, i) => {
    const num = p.querySelector('.page-number');
    if (num) num.textContent = 'Page ' + (i+1) + ' | P a g e';
  });
});
</script>

</body>
</html>
